(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5183:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let l=a(5125).A.create({baseURL:"https://gama-apps-cloud.uc.r.appspot.com"});l.interceptors.request.use(e=>{try{let s=localStorage.getItem("authToken");s&&e&&e.headers&&(e.headers.Authorization="Bearer ".concat(s))}catch(e){}return e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e,e=>{if(e&&e.response&&401===e.response.status)try{localStorage.removeItem("authToken"),window.location.href="/login"}catch(e){}return Promise.reject(e)});let t=l},9418:(e,s,a)=>{Promise.resolve().then(a.bind(a,9547))},9547:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>d});var l=a(5155),t=a(2115),n=a(5239),r=a(5183),i=a(63);function d(){var e,s,a,d,c,o,x,m,h;let[u,p]=(0,t.useState)(null),[g,b]=(0,t.useState)(!1),[j,v]=(0,t.useState)(null),[N,f]=(0,t.useState)(null),[y,w]=(0,t.useState)(null),[_,k]=(0,t.useState)(null),[R,A]=(0,t.useState)({kcal:0,protein:0,carbs:0,fats:0}),S=(0,i.useRouter)();(0,t.useEffect)(()=>{localStorage.getItem("authToken")||S.push("/login")},[S]),(0,t.useEffect)(()=>{var e;if(null==N?void 0:N.analise_nutricional){let{calorias_totais:e,macronutrientes:s}=N.analise_nutricional;A({kcal:e||0,protein:(null==s?void 0:s.proteinas_g)||0,carbs:(null==s?void 0:s.carboidratos_g)||0,fats:(null==s?void 0:s.gorduras_g)||0})}else if(null==y||null==(e=y.resultado)?void 0:e.resumo_nutricional){let{total_calorias:e,total_proteinas_g:s,total_carboidratos_g:a,total_gorduras_g:l}=y.resultado.resumo_nutricional;A({kcal:e||0,protein:s||0,carbs:a||0,fats:l||0})}},[N,y]);let C=async(e,s)=>{b(!0),v(null),f(null),w(null),k(s),A({kcal:0,protein:0,carbs:0,fats:0});let a=new FormData;a.append("scan"===s?"imagem":"file",e);try{console.log("\uD83D\uDCE4 Enviando imagem para ".concat("scan"===s?"scan r\xe1pido":"an\xe1lise detalhada","..."));let e="scan"===s?"/api/refeicoes/scan-rapido":"/api/refeicoes/analisar-imagem-detalhado";if(console.log("\uD83D\uDD0D Debug URL:",{baseURL:r.A.defaults.baseURL,endpoint:e,fullURL:r.A.defaults.baseURL+e}),"scan"===s){let s=await r.A.post(e,a);console.log("✅ Resposta do scan recebida:",s.data),w(s.data)}else{let s=await r.A.post(e,a);console.log("✅ Resposta da an\xe1lise recebida:",s.data),f(s.data)}}catch(e){var l,t;console.error("❌ Erro ao chamar o backend:",e),v((null==(t=e.response)||null==(l=t.data)?void 0:l.detail)||e.message||"Ocorreu um erro desconhecido.")}finally{b(!1)}},P=async(e,s)=>{var a;let l=null==(a=e.target.files)?void 0:a[0];l&&(p(URL.createObjectURL(l)),await C(l,s),e.target.value="")};return(0,l.jsx)("main",{className:"flex justify-center items-center min-h-screen font-sans bg-gray-100 p-4",children:(0,l.jsxs)("div",{className:"container mx-auto max-w-2xl bg-white shadow-2xl rounded-2xl p-6 md:p-8",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("h1",{className:"text-3xl md:text-4xl font-extrabold text-gray-900 mb-2",children:"Seu Prato"}),(0,l.jsx)("p",{className:"text-gray-500",children:"Fotografe seu prato e receba uma an\xe1lise nutricional inteligente."})]}),(0,l.jsx)("button",{onClick:()=>{localStorage.removeItem("authToken"),S.push("/login")},className:"bg-red-500 text-white font-bold py-2 px-4 rounded-full transition duration-300 hover:bg-red-600 shadow-lg",children:"Sair"})]}),(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-6",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsxs)("label",{htmlFor:"analysis-upload",className:"cursor-pointer inline-block bg-sky-500 text-white font-bold py-3 px-6 rounded-full transition duration-300 hover:bg-sky-600 shadow-lg w-full sm:w-auto",children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 inline-block mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4.586-4.586a2 2 0 012.828 0L16 15z",clipRule:"evenodd"})}),"An\xe1lise Detalhada"]}),(0,l.jsx)("input",{type:"file",id:"analysis-upload",accept:"image/*",className:"hidden",onChange:e=>P(e,"analysis")}),(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"An\xe1lise completa + recomenda\xe7\xf5es"})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsxs)("label",{htmlFor:"scan-upload",className:"cursor-pointer inline-block bg-emerald-500 text-white font-bold py-3 px-6 rounded-full transition duration-300 hover:bg-emerald-600 shadow-lg w-full sm:w-auto",children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 inline-block mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"})}),"Scan R\xe1pido"]}),(0,l.jsx)("input",{type:"file",id:"scan-upload",accept:"image/*",className:"hidden",onChange:e=>P(e,"scan")}),(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Identifica\xe7\xe3o r\xe1pida + calorias"})]})]}),u&&(0,l.jsxs)("div",{id:"results-container",children:[(0,l.jsx)("div",{className:"relative w-full max-w-md mx-auto aspect-square bg-gray-200 rounded-xl overflow-hidden mb-6",children:(0,l.jsx)(n.default,{src:u,alt:"Prato de comida",fill:!0,style:{objectFit:"cover"}})}),(0,l.jsxs)("div",{className:"bg-gray-50 p-4 rounded-xl mb-6",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-4 text-center",children:"scan"===_?"Scan R\xe1pido":"An\xe1lise Detalhada"}),g&&(0,l.jsx)("div",{className:"text-center text-gray-500 mb-4",children:"scan"===_?"Escaneando...":"Analisando..."}),j&&(0,l.jsx)("div",{className:"text-red-500 text-center p-2 bg-red-100 rounded",children:j}),!g&&(0,l.jsxs)(l.Fragment,{children:["scan"===_&&(()=>{if(!(null==y?void 0:y.resultado))return null;let{alimentos_extraidos:e,alertas:s}=y.resultado;return(0,l.jsxs)(l.Fragment,{children:[e&&e.length>0&&(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h3",{className:"font-semibold text-lg text-gray-800 mb-2",children:"Alimentos Identificados:"}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full bg-white",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"py-2 px-4 border-b",children:"Alimento"}),(0,l.jsx)("th",{className:"py-2 px-4 border-b",children:"Categoria"}),(0,l.jsx)("th",{className:"py-2 px-4 border-b",children:"Quantidade (g)"}),(0,l.jsx)("th",{className:"py-2 px-4 border-b",children:"Calorias"}),(0,l.jsx)("th",{className:"py-2 px-4 border-b",children:"Confian\xe7a"})]})}),(0,l.jsx)("tbody",{children:e.map((e,s)=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"py-2 px-4 border-b",children:e.nome}),(0,l.jsx)("td",{className:"py-2 px-4 border-b",children:e.categoria}),(0,l.jsx)("td",{className:"py-2 px-4 border-b",children:e.quantidade_estimada_g}),(0,l.jsx)("td",{className:"py-2 px-4 border-b",children:e.calorias_estimadas}),(0,l.jsx)("td",{className:"py-2 px-4 border-b",children:(0,l.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat("alta"===e.confianca?"bg-green-100 text-green-800":"media"===e.confianca?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.confianca})})]},s))})]})})]}),s&&s.length>0&&(0,l.jsxs)("div",{className:"mb-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,l.jsx)("h4",{className:"font-semibold text-yellow-800 mb-2",children:"Alertas:"}),(0,l.jsx)("ul",{className:"list-disc list-inside text-sm text-yellow-700",children:s.map((e,s)=>(0,l.jsx)("li",{children:e},s))})]})]})})(),"analysis"===_&&(N?(0,l.jsxs)(l.Fragment,{children:[(null==(s=N.detalhes_prato)||null==(e=s.alimentos)?void 0:e.length)>0&&(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h3",{className:"font-semibold text-lg text-gray-800 mb-2",children:"Alimentos Identificados:"}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full bg-white",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"py-2 px-4 border-b",children:"Alimento"}),(0,l.jsx)("th",{className:"py-2 px-4 border-b",children:"Quantidade (g)"}),(0,l.jsx)("th",{className:"py-2 px-4 border-b",children:"M\xe9todo de Preparo"})]})}),(0,l.jsx)("tbody",{children:N.detalhes_prato.alimentos.map((e,s)=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"py-2 px-4 border-b",children:e.nome}),(0,l.jsx)("td",{className:"py-2 px-4 border-b",children:e.quantidade_gramas}),(0,l.jsx)("td",{className:"py-2 px-4 border-b",children:e.metodo_preparo})]},s))})]})})]}),N.analise_nutricional&&(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h3",{className:"font-semibold text-lg text-gray-800 mb-2",children:"An\xe1lise Nutricional:"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"bg-blue-50 p-4 rounded",children:[(0,l.jsx)("h4",{className:"font-medium text-blue-800",children:"Calorias Totais"}),(0,l.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:[N.analise_nutricional.calorias_totais," kcal"]})]}),(0,l.jsxs)("div",{className:"bg-green-50 p-4 rounded",children:[(0,l.jsx)("h4",{className:"font-medium text-green-800",children:"Macronutrientes"}),(0,l.jsxs)("p",{className:"text-sm text-green-600",children:["Prote\xednas: ",null==(a=N.analise_nutricional.macronutrientes)?void 0:a.proteinas_g,"g",(0,l.jsx)("br",{}),"Carboidratos: ",null==(d=N.analise_nutricional.macronutrientes)?void 0:d.carboidratos_g,"g",(0,l.jsx)("br",{}),"Gorduras: ",null==(c=N.analise_nutricional.macronutrientes)?void 0:c.gorduras_g,"g"]})]})]}),(null==(o=N.analise_nutricional.vitaminas_minerais)?void 0:o.length)>0&&(0,l.jsxs)("div",{className:"mt-4 bg-purple-50 p-4 rounded",children:[(0,l.jsx)("h4",{className:"font-medium text-purple-800",children:"Vitaminas e Minerais Principais"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:N.analise_nutricional.vitaminas_minerais.map((e,s)=>(0,l.jsx)("span",{className:"bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded",children:e},s))})]})]}),N.recomendacoes&&(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h3",{className:"font-semibold text-lg text-gray-800 mb-2",children:"Recomenda\xe7\xf5es:"}),(0,l.jsxs)("div",{className:"space-y-4",children:[(null==(x=N.recomendacoes.pontos_positivos)?void 0:x.length)>0&&(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-medium text-green-600",children:"Pontos Positivos:"}),(0,l.jsx)("ul",{className:"list-disc list-inside text-sm text-gray-600",children:N.recomendacoes.pontos_positivos.map((e,s)=>(0,l.jsx)("li",{children:e},s))})]}),(null==(m=N.recomendacoes.sugestoes_balanceamento)?void 0:m.length)>0&&(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-medium text-yellow-600",children:"Sugest\xf5es de Balanceamento:"}),(0,l.jsx)("ul",{className:"list-disc list-inside text-sm text-gray-600",children:N.recomendacoes.sugestoes_balanceamento.map((e,s)=>(0,l.jsx)("li",{children:e},s))})]}),(null==(h=N.recomendacoes.alternativas_saudaveis)?void 0:h.length)>0&&(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-medium text-blue-600",children:"Alternativas Saud\xe1veis:"}),(0,l.jsx)("ul",{className:"list-disc list-inside text-sm text-gray-600",children:N.recomendacoes.alternativas_saudaveis.map((e,s)=>(0,l.jsx)("li",{children:e},s))})]})]})]})]}):null),(N||y)&&(0,l.jsxs)("div",{className:"bg-gray-100 p-4 rounded-lg mt-6",children:[(0,l.jsx)("h4",{className:"font-semibold text-gray-800 mb-2",children:"Resumo Nutricional:"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:R.kcal}),(0,l.jsx)("p",{className:"text-xs text-gray-600",children:"Calorias"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:[R.protein,"g"]}),(0,l.jsx)("p",{className:"text-xs text-gray-600",children:"Prote\xednas"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"text-2xl font-bold text-orange-600",children:[R.carbs,"g"]}),(0,l.jsx)("p",{className:"text-xs text-gray-600",children:"Carboidratos"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"text-2xl font-bold text-red-600",children:[R.fats,"g"]}),(0,l.jsx)("p",{className:"text-xs text-gray-600",children:"Gorduras"})]})]})]})]})]})]})]})})}}},e=>{e.O(0,[714,239,441,255,358],()=>e(e.s=9418)),_N_E=e.O()}]);